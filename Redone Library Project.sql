CREATE DATABASE db_booksFinalProject;
GO
USE db_booksFinalProject;
GO

--Tables-===============================================

--create and populate Publisher table
CREATE TABLE tbl_publishers(
	Name VARCHAR (50) UNIQUE,
	PublisherAddress VARCHAR(50),
	Phone VARCHAR(30)
);
INSERT INTO tbl_publishers
VALUES ('Aladdin Paperbacks','50490 Manley Avenue','9327590219'),
('Allen Lane','015 Garrison Point','6658043794'),
('Anchor','98627 Sullivan Alley','1811957736'),
('Anchor Books','3 Southridge Trail','6885227355'),
('Arthur A. Levine Books','083 Fulton Center','8836920759'),
('Atria Books','4 Steensland Alley','3114575809'),
('Back Bay Books','8 Annamark Park','2093072235'),
('Ballantine Books','4582 Pierstorff Circle','7779077298'),
('Ballantine Books (Ballantine Reader''s Circle)','404 4th Road','8144582360'),
('Bantam','413 Grim Center','6718926037'),
('Bantam Books','59 Oneill Center','6168369223'),
('Bantam Spectra','19489 Dawn Center','6702980902'),
('Berkley Books','81 Elgar Parkway','7597492071'),
('Black Dog & Leventhal Publishers','16 Goodland Junction','7534127460'),
('Black Swan','742 Fulton Avenue','8158998622'),
('Bloomsbury Publishing PLC','65 Summerview Circle','5734276659'),
('Chicago Review Press','4 Lerdahl Park','7716152759'),
('Corgi','2 Clarendon Junction','9837499221'),
('Crossing Press','6 Jana Trail','5413621057'),
('Del Rey Books','58 Farmco Road','9346908229'),
('Dial Press','5 North Trail','8626291307'),
('Doubleday & Company, Inc.','27 Eastlawn Center','7439171069'),
('Dutton','71 Shopko Court','9529062348'),
('Ecco','27332 Walton Center','5519228624'),
('Ember','0431 Esker Trail','3589632256'),
('Farrar, Straus and Giroux','22 Nobel Road','6933742668'),
('Fourth Estate Paperbacks','3 Evergreen Street','8598909013'),
('Green Integer','0 Toban Lane','1166351174'),
('Grove Press','780 Welch Lane','4401665914'),
('Hackett Publishing Company, Inc.','5046 Michigan Park','7258300587'),
('Harper','2 Darwin Park','8314921358'),
('Harper Perennial','30 Swallow Court','6486668188'),
('Harper Perennial Modern Classics','7509 Dapin Point','3292530106'),
('HarperCollins HarperTorch','54 Chinook Crossing','4904235726'),
('HarperCollins Publishers','6 Warrior Trail','9824008743'),
('Headline Review','7 Linden Plaza','9517440732'),
('Houghton Mifflin','7 Village Green Lane','5706134250'),
('Howard Publishing Co','96 American Court','8544541486'),
('Laurel Leaf','8321 Longview Trail','1177176789'),
('Little, Brown','8 Fuller Trail','5912104315'),
('Mariner Books','13605 Gulseth Crossing','4667651956'),
('McClelland & Stewart','9 Division Place','9132975383'),
('McSweeney''s','8 Bonner Court','9778352115'),
('Modern Library','229 Lyons Trail','1548187824'),
('NAL','17 Talmadge Center','3148933863'),
('NAL Trade','8280 Canary Parkway','5005049800'),
('New American Library','8078 Calypso Circle','5685485176'),
('Pan MacMillan','89155 Coleman Court','4338584361'),
('Penguin Books','10713 Burrows Park','3301687566'),
('Picador USA','6326 Miller Road','2456897789'),
('Quality Paperback Book Club','0012 David Center','3632121199'),
('Random House','44 Arkansas Trail','1648198683'),
('Recorded Books LLC','4 Lukken Junction','3439811376'),
('Roc','06 Larry Drive','3422894820'),
('Saga Press','7 Mayer Court','4393777502'),
('Scholastic','0 Atwood Alley','5022265550'),
('Scholastic Inc','16688 Pawling Street','5933305523'),
('Scholastic Inc.','5 Petterle Circle','9399742213'),
('Seal Books','91 Cody Trail','6024283680'),
('Signet Classics','901 Commercial Plaza','9582006344'),
('Time Warner Books','615 Hansons Lane','4253194785'),
('Tor Books','0 Stone Corner Avenue','2005124834'),
('Vintage','97 Fair Oaks Avenue','9064687666'),
('Vintage Contemporaries','600 Crest Line Center','6456432624'),
('Vintage Espanol','95378 Dennis Drive','1098745165'),
('Vintage International','302 Corscot Pass','8247889926'),
('W. W. Norton  Company','95944 Corry Pass','7948235834'),
('W.W. Norton & Company (NYC)','56 High Crossing Parkway','9674778588'),
('William Morrow','6 Milwaukee Point','8075118850'),
('William Morrow Paperbacks','87 Upham Court','5182569625');

--create and populate Books table
CREATE TABLE tbl_books(
	BookId INT PRIMARY KEY NOT NULL,
	Title VARCHAR (300),
	PublisherName VARCHAR (50) FOREIGN KEY REFERENCES tbl_publishers(Name)
);
INSERT INTO tbl_books
VALUES (987987,'The Lost Tribe','Allen Lane'),
(13654,'Tehanu (Earthsea Cycle, #4)','Aladdin Paperbacks'),
(706,'America (The Book): A Citizen''s Guide to Democracy Inaction','Allen Lane'),
(16271,'The Intuitionist','Anchor'),
(17650,'The Robber Bride','Anchor'),
(37781,'Things Fall Apart','Anchor Books'),
(15881,'Harry Potter and the Chamber of Secrets (Harry Potter, #2)','Arthur A. Levine Books'),
(40440,'The Thirteenth Tale','Atria Books'),
(5107,'The Catcher in the Rye','Back Bay Books'),
(43841,'When Christ and His Saints Slept  (Henry II and Eleanor of Aquitaine, #1)','Ballantine Books'),
(21787,'The Princess Bride','Ballantine Books (Ballantine Reader''s Circle)'),
(10572,'A Clash of Kings  (A Song of Ice and Fire, #2)','Bantam'),
(13496,'A Game of Thrones (A Song of Ice and Fire, #1)','Bantam'),
(13497,'A Feast for Crows (A Song of Ice and Fire, #4)','Bantam Books'),
(13642,'A Wizard of Earthsea (Earthsea Cycle, #1)','Bantam Spectra'),
(22320,'Pattern Recognition (Blue Ant, #1)','Berkley Books'),
(16328,'The Murder of Roger Ackroyd (Hercule Poirot #4)','Black Dog & Leventhal Publishers'),
(16255,'Tales of the City (Tales of the City, #1)','Black Swan'),
(10956,'The Virgin Suicides','Bloomsbury Publishing PLC'),
(33609,'Katherine','Chicago Review Press'),
(34484,'Small Gods (Discworld, #13)','Corgi'),
(32951,'Sister Outsider: Essays and Speeches','Crossing Press'),
(11,'The Hitchhiker''s Guide to the Galaxy (Hitchhiker''s Guide to the Galaxy, #1)','Del Rey Books'),
(4981,'Slaughterhouse-Five','Dial Press'),
(23919,'The Complete Stories and Poems','Doubleday & Company, Inc.'),
(5064,'World Without End (Kingsbridge, #2)','Dutton'),
(39774,'Mockingbird Wish Me Luck','Ecco'),
(3636,'The Giver (The Giver, #1)','Ember'),
(428,'Play It as It Lays','Farrar, Straus and Giroux'),
(12764,'The Death of Artemio Cruz','Farrar, Straus and Giroux'),
(3805,'The Corrections','Fourth Estate Paperbacks'),
(4900,'Heart of Darkness','Green Integer'),
(11702,'The Labyrinth of Solitude and Other Writings','Grove Press'),
(15055,'Oranges Are Not the Only Fruit','Grove Press'),
(30292,'Five Dialogues: Euthyphro, Apology, Crito, Meno, Phaedo','Hackett Publishing Company, Inc.'),
(320,'One Hundred Years of Solitude','Harper'),
(34497,'The Color of Magic (Discworld, #1; Rincewind #1)','Harper'),
(5220,'The Poisonwood Bible','Harper Perennial'),
(34507,'Equal Rites (Discworld, #3; Witches, #1)','Harper Perennial'),
(39926,'The Beauty Myth','Harper Perennial'),
(2657,'To Kill a Mockingbird (To Kill a Mockingbird, #1)','Harper Perennial Modern Classics'),
(5755,'The Language Instinct: How the Mind Creates Language','Harper Perennial Modern Classics'),
(6514,'The Bell Jar','Harper Perennial Modern Classics'),
(37415,'Their Eyes Were Watching God','Harper Perennial Modern Classics'),
(2744,'Anansi Boys (American Gods)','HarperCollins HarperTorch'),
(14891,'A Tree Grows in Brooklyn','HarperCollins Publishers'),
(4407,'American Gods (American Gods, #1)','Headline Review'),
(5907,'The Hobbit','Houghton Mifflin'),
(1078,'The Good Earth (House of Earth, #1)','Howard Publishing Co'),
(18122,'The Amber Spyglass (His Dark Materials, #3)','Laurel Leaf'),
(7178,'The Catcher in the Rye','Little, Brown'),
(4588,'Extremely Loud and Incredibly Close','Mariner Books'),
(11038,'Henry and June: From "A Journal of Love"--The Unexpurgated Diary of Anaïs Nin (1931-1932)','Mariner Books'),
(11713,'The English Patient','McClelland & Stewart'),
(4952,'What Is the What','McSweeney''s'),
(1885,'Pride and Prejudice','Modern Library'),
(7613,'Animal Farm','NAL'),
(5043,'The Pillars of the Earth (Kingsbridge, #1)','NAL Trade'),
(5470,'1984','New American Library'),
(10847,'Under the Banner of Heaven: A Story of Violent Faith','Pan MacMillan'),
(890,'Of Mice and Men','Penguin Books'),
(4406,'East of Eden','Penguin Books'),
(4965,'Year of Wonders','Penguin Books'),
(6192,'Disgrace','Penguin Books'),
(7763,'The Joy Luck Club','Penguin Books'),
(12296,'The Scarlet Letter','Penguin Books'),
(15195,'The Complete Maus (Maus, #1-2)','Penguin Books'),
(25079,'The Commitment: Love, Sex, Marriage, and My Family','Penguin Books'),
(27003,'The Eyre Affair (Thursday Next, #1)','Penguin Books'),
(2187,'Middlesex','Picador USA'),
(27499,'Leaves of Grass, The Deathbed Edition','Quality Paperback Book Club'),
(1103,'Snow Flower and the Secret Fan','Random House'),
(18889,'Lady of Avalon (Avalon, #3)','Recorded Books LLC'),
(18892,'The Forest House (Avalon, #2)','Roc'),
(13662,'The Tombs of Atuan (Earthsea Cycle, #2)','Saga Press'),
(6,'Harry Potter and the Goblet of Fire (Harry Potter, #4)','Scholastic'),
(3,'Harry Potter and the Sorcerer''s Stone (Harry Potter, #1)','Scholastic Inc'),
(1,'Harry Potter and the Half-Blood Prince (Harry Potter, #6)','Scholastic Inc.'),
(5,'Harry Potter and the Prisoner of Azkaban (Harry Potter, #3)','Scholastic Inc.'),
(4214,'Life of Pi','Seal Books'),
(1934,'Little Women (Little Women, #1)','Signet Classics'),
(10692,'The Historian','Time Warner Books'),
(14201,'Jonathan Strange & Mr Norrell','Tor Books'),
(1875,'The History of Sexuality, Volume 1: An Introduction','Vintage'),
(3656,'The Sea','Vintage'),
(7815,'The Year of Magical Thinking','Vintage'),
(12497,'No Country for Old Men','Vintage'),
(14028,'Snow Country','Vintage'),
(14836,'Midnight''s Children','Vintage'),
(16981,'Invisible Man','Vintage'),
(29044,'The Secret History','Vintage'),
(41913,'The Children of Men','Vintage'),
(11437,'Where I''m Calling From: New and Selected Stories','Vintage Contemporaries'),
(762,'Crónica de una muerte anunciada','Vintage Espanol'),
(9712,'Love in the Time of Cholera','Vintage International'),
(32145,'Stiff: The Curious Lives of Human Cadavers','W. W. Norton  Company'),
(14990,'Spook: Science Tackles the Afterlife','W.W. Norton & Company (NYC)'),
(12067,'Good Omens: The Nice and Accurate Prophecies of Agnes Nutter, Witch','William Morrow'),
(17607,'All About Love: New Visions','William Morrow'),
(14497,'Neverwhere (London Below, #1)','William Morrow Paperbacks');

--create and populate Book authors table
CREATE TABLE tbl_bookAuthors(
	BookId INT FOREIGN KEY REFERENCES tbl_books(BookId),
	AuthorName VARCHAR (50)
);
INSERT INTO tbl_bookAuthors
VALUES (1,'J.K. Rowling'),
(3,'J.K. Rowling'),
(5,'J.K. Rowling'),
(6,'J.K. Rowling'),
(11,'Douglas Adams'),
(320,'Gabriel García Márquez'),
(428,'Joan Didion'),
(706,'Jon Stewart'),
(762,'Gabriel García Márquez'),
(890,'John Steinbeck'),
(1078,'Pearl S. Buck'),
(1103,'Stephen King'),
(1875,'Michel Foucault'),
(1885,'Jane Austen'),
(1934,'Louisa May Alcott'),
(2187,'Jeffrey Eugenides'),
(2657,'Harper Lee'),
(2744,'Neil Gaiman'),
(3636,'Lois Lowry'),
(3656,'John Banville'),
(3805,'Jonathan Franzen'),
(4214,'Yann Martel'),
(4406,'John Steinbeck'),
(4407,'Neil Gaiman'),
(4588,'Jonathan Safran Foer'),
(4900,'Joseph Conrad'),
(4952,'Dave Eggers'),
(4965,'Geraldine Brooks'),
(4981,'Kurt Vonnegut'),
(5043,'Ken Follett'),
(5064,'Ken Follett'),
(5107,'J.D. Salinger'),
(5220,'Barbara Kingsolver'),
(5470,'George Orwell'),
(5755,'Steven Pinker'),
(5907,'J.R.R. Tolkien'),
(6192,'J.M. Coetzee'),
(6514,'Sylvia Plath'),
(7178,'Stephen King'),
(7613,'George Orwell'),
(7763,'Amy Tan'),
(7815,'Joan Didion'),
(9712,'Gabriel García Márquez'),
(10572,'George R.R. Martin'),
(10692,'Elizabeth Kostova'),
(10847,'Jon Krakauer'),
(10956,'Stephen King'),
(11038,'Anaïs Nin'),
(11437,'Raymond Carver'),
(11702,'Octavio Paz'),
(11713,'Michael Ondaatje'),
(12067,'Terry Pratchett'),
(12296,'Nathaniel Hawthorne'),
(12497,'Cormac McCarthy'),
(12764,'Carlos Fuentes'),
(13496,'George R.R. Martin'),
(13497,'George R.R. Martin'),
(13642,'Ursula K. Le Guin'),
(13654,'Ursula K. Le Guin'),
(13662,'Ursula K. Le Guin'),
(14028,'Yasunari Kawabata'),
(14201,'Susanna Clarke'),
(14497,'Neil Gaiman'),
(14836,'Salman Rushdie'),
(14891,'Betty  Smith'),
(14990,'Mary Roach'),
(15055,'Jeanette Winterson'),
(15195,'Art Spiegelman'),
(15881,'J.K. Rowling'),
(16255,'Armistead Maupin'),
(16271,'Colson Whitehead'),
(16328,'Agatha Christie'),
(16981,'Ralph Ellison'),
(17607,'bell hooks'),
(17650,'Margaret Atwood'),
(18122,'Philip Pullman'),
(18889,'Marion Zimmer Bradley'),
(18892,'Marion Zimmer Bradley'),
(21787,'William Goldman'),
(22320,'William Gibson'),
(23919,'Edgar Allan Poe'),
(25079,'Dan Savage'),
(27003,'Jasper Fforde'),
(27499,'Walt Whitman'),
(29044,'Donna Tartt'),
(30292,'Plato'),
(32145,'Mary Roach'),
(32951,'Audre Lorde'),
(33609,'Stephen King'),
(34484,'Terry Pratchett'),
(34497,'Terry Pratchett'),
(34507,'Terry Pratchett'),
(37415,'Zora Neale Hurston'),
(37781,'Chinua Achebe'),
(39774,'Charles Bukowski'),
(39926,'Naomi Wolf'),
(40440,'Diane Setterfield'),
(41913,'P.D. James'),
(43841,'Sharon Kay Penman');

-- create and populate Borrower table
CREATE TABLE tbl_borrower (
	CardNo INT PRIMARY KEY NOT NULL IDENTITY (1000000000, 1),
	Name VARCHAR (50),
	BorrowerAddress VARCHAR (50),
	Phone VARCHAR (50)
);
INSERT INTO tbl_borrower(Name,BorrowerAddress,Phone)
VALUES ('Hester Draysay','0406 Vera Hill','4081841808'),
('Auberta Steffan','2546 Paget Street','2947199011'),
('Betteanne Morrowe','895 Marcy Circle','4162890746'),
('Palm Blowin','174 Shasta Hill','7171229672'),
('Zebulon Flockhart','1582 Marquette Avenue','1466165147'),
('Curran Moller','26544 Pepper Wood Street','3644484341'),
('Lizbeth Fowler','3 Northport Plaza','7654244731'),
('Patsy Balden','8 Sauthoff Pass','1972259119'),
('Natalee Sauniere','7 South Way','6106083514'),
('Lorens Brighouse','4592 Bunting Drive','8903247488'),
('Aland Kramer','68359 Pepper Wood Alley','3879702592'),
('Sandra Emslie','39449 Sycamore Lane','3761491963'),
('Ariela Gilliat','397 Oak Junction','9726282904'),
('Karry Sturror','6 Graceland Point','6735460238'),
('Jillana Major','64 Schmedeman Pass','4443935014'),
('Nessi Birks','6 Mosinee Crossing','2825287564'),
('Garvin Rignall','209 Golf Course Trail','5409888130'),
('Jenda Dreakin','3098 Merry Park','4419249540'),
('Skylar Leavry','6761 Moulton Terrace','5193647029'),
('Cheston Terran','3 Dahle Terrace','7708182203'),
('Gwendolyn McNutt','23 Sauthoff Hill','1978674493'),
('Had Anstee','7379 Bluejay Center','2244631443'),
('Mellisent Pearl','05 Tennyson Court','3534351140'),
('Ailbert Duddy','9 School Alley','7829108691'),
('Lancelot O''Heffernan','27 1st Pass','1521918652'),
('Piggy McGarahan','391 Mockingbird Place','1829447685'),
('Mercy MacHoste','86 Tennessee Parkway','6757012688'),
('Nancie Kapiloff','850 Forest Run Road','9335981409'),
('Hercule Pobjay','66 Dottie Terrace','3376294708'),
('Clare Mackley','6076 Lillian Alley','8781412528'),
('Nell Pavlik','2735 Hoffman Place','8773981099'),
('Ethelred Ely','4 Spenser Pass','8549925222'),
('Yancey Agglione','94211 Rockefeller Trail','9103815827'),
('Rudy Collymore','86659 Hansons Point','7952266617'),
('Rossy Keyworth','50216 Beilfuss Way','1343814330'),
('Tiffani Siward','7347 Coleman Parkway','8163398660'),
('Holden Stonelake','8 Pankratz Point','8016557776'),
('Hamel Ferres','0 Farmco Hill','2403144190'),
('Kelley Lethieulier','10818 Ryan Avenue','6111890843'),
('Sauncho Kohnemann','35 Portage Parkway','2081942115'),
('Kylie Urlich','91809 Pine View Circle','7744842048'),
('Francklin Kestle','029 5th Junction','7427721214'),
('Wayne Waterman','719 Summit Circle','9391231624'),
('Percival Sedgemond','0 Norway Maple Alley','5247870048'),
('Britt Nowland','6 School Place','2963664465'),
('Clary Kneal','4 Pennsylvania Center','5911710674'),
('Kinna Sperwell','89 Graceland Court','6662174637'),
('Audrie Climer','911 Talisman Terrace','9405539449'),
('Nye Korn','2466 Darwin Point','7827604873'),
('Enoch Stangoe','66 Manufacturers Plaza','7396940052'),
('Elaina Beaford','2 Memorial Circle','8024036126'),
('Angela Stetlye','249 Goodland Lane','8064813323'),
('Arlan Ilyin','82966 Hovde Junction','9354060779'),
('Quintilla Sandwick','260 Cardinal Place','6036795209'),
('Kyrstin O''Canavan','30057 Myrtle Place','6065526417'),
('Lira Kingsbury','9918 Autumn Leaf Circle','4213901104'),
('Ferne Warbeys','584 Kipling Avenue','6075104482'),
('Tammy Bennike','3 Moulton Park','3245411117'),
('Hakeem Andrin','99477 Holmberg Junction','5019895925'),
('Stacia Hatzar','91137 Rockefeller Terrace','6528280530'),
('Nessie Elbourn','66516 Summit Park','7132562015'),
('Davidson Dowman','8 Bashford Park','1094064060'),
('Walden Joicey','76 Dahle Avenue','9866464216'),
('Twyla Westpfel','328 Miller Center','9839065936'),
('La verne Mallows','545 Bowman Junction','4228058625'),
('Hansiain Marvelley','1308 Colorado Way','8709509529'),
('Cynthea Deinhard','37361 Caliangt Way','7271444692'),
('Bealle Burmaster','1079 Lawn Junction','8283376191'),
('Gerrilee Donovan','3835 Maple Wood Plaza','5817028400'),
('Tallulah Louys','1616 Knutson Pass','6527524071'),
('Cello Sarchwell','36 Moland Junction','7233192264'),
('Nollie Innwood','60 Novick Hill','2914267781'),
('Doug Trippick','3 Fair Oaks Center','8284794403'),
('Donnajean Ciubutaro','56491 Continental Pass','8517745072'),
('Petr Waistall','356 Hudson Crossing','5883839051'),
('Meade Filimore','18429 Valley Edge Circle','6332710467'),
('Lanna Rundle','57336 Independence Parkway','2057856517'),
('Quintus Yorath','056 Starling Road','8172286451'),
('Alaster Lobbe','085 Quincy Court','4023082069'),
('Friederike Ottosen','8709 Ramsey Way','2129970196'),
('Jean Summerfield','92102 Steensland Terrace','4873623219'),
('Riki MacGeaney','46051 Sheridan Drive','5986914548'),
('Tiffie Ridgedell','44 Northfield Court','8653583297'),
('Brunhilde Spykings','1373 Homewood Plaza','5442147994'),
('Alex Giddons','7675 Hagan Point','8249779015'),
('Shena Bonfield','10084 Meadow Ridge Trail','5741656112'),
('Phaedra Szwandt','82 Hazelcrest Junction','2605397731'),
('Wilton Whimp','375 Sugar Place','7652569420'),
('Goldina Yeiles','90 Sutherland Point','8292101734'),
('Hedwig Cassidy','643 Ramsey Center','7477984860'),
('Devy Blethyn','556 Spenser Park','5434279311'),
('Kimball Ciric','70886 Clove Center','5713888856'),
('Lambert Hinkes','8 Jay Lane','9886409362'),
('Tillie Lemm','3 Sachtjen Park','7809658738'),
('Elke Mothersole','12833 Judy Road','5487296925'),
('Ainsley Dzenisenka','14 Union Park','5345998924'),
('Brig Barkes','4 Ilene Pass','6347505799'),
('Godfrey Cheetham','919 Golf View Street','7945331051'),
('Johnathon Sprowle','00 Sugar Place','2906298817');

--create and populate Library Branch table
CREATE TABLE tbl_libraryBranch (
	BranchID INT PRIMARY KEY NOT NULL IDENTITY (1,1),
	BranchName VARCHAR (50),
	BranchAddress VARCHAR (50)
);
INSERT INTO tbl_libraryBranch(BranchName,BranchAddress)
VALUES ('Central','193 Dapin Street'),
('Sharpstown','790 Jenna Crossing'),
('Sawahrandu','26087 Walton Hill'),
('Asino','3 Dwight Place'),
('Mabini','9 Erie Center'),
('Xishan','5 Amoth Court'),
('Tallahassee','1973 Service Plaza'),
('Jiaoyuan','569 Mccormick Trail');

--create and populate Book Copies table
CREATE TABLE tbl_bookCopies ( 
	BookID INT FOREIGN KEY REFERENCES tbl_books(BookID),
	BranchID INT FOREIGN KEY REFERENCES tbl_libraryBranch(BranchID),
	No_of_copies INT
);
INSERT INTO tbl_bookCopies
VALUES (987987,2,3),
(987987,4,2),
(987987,5,1),
(13654,6,5),
(706,6,3),
(16271,3,5),
(17650,2,5),
(37781,5,4),
(15881,5,3),
(40440,4,3),
(5107,6,4),
(43841,8,2),
(21787,6,2),
(10572,6,2),
(13496,4,5),
(13497,6,5),
(13642,8,4),
(22320,8,5),
(16328,7,4),
(16255,6,3),
(10956,1,5),
(33609,1,4),
(34484,4,3),
(32951,5,5),
(11,4,2),
(4981,6,4),
(23919,1,3),
(5064,3,3),
(39774,5,2),
(3636,8,5),
(428,2,5),
(12764,4,5),
(3805,2,2),
(4900,7,5),
(11702,1,5),
(15055,4,5),
(30292,2,4),
(320,2,2),
(34497,4,5),
(5220,8,2),
(34507,4,2),
(39926,6,3),
(2657,6,2),
(5755,5,3),
(6514,8,4),
(37415,5,5),
(2744,6,4),
(14891,6,5),
(4407,7,5),
(5907,7,5),
(1078,5,3),
(18122,8,2),
(7178,1,4),
(4588,4,4),
(11038,3,5),
(11713,6,3),
(4952,6,5),
(1885,6,4),
(7613,8,4),
(5043,8,4),
(5470,7,2),
(10847,8,2),
(890,3,2),
(4406,6,2),
(4965,7,5),
(6192,5,3),
(7763,4,5),
(12296,1,3),
(15195,4,3),
(25079,1,5),
(27003,1,4),
(2187,3,5),
(27499,7,5),
(1103,2,4),
(18889,7,2),
(18892,2,4),
(13662,6,5),
(6,6,3),
(3,6,4),
(1,3,5),
(5,5,4),
(4214,7,4),
(1934,7,5),
(10692,6,2),
(14201,4,2),
(1875,2,3),
(3656,1,4),
(7815,2,5),
(12497,6,4),
(14028,2,4),
(14836,3,5),
(16981,7,4),
(29044,7,5),
(41913,5,5),
(11437,6,2),
(762,5,2),
(9712,6,2),
(32145,2,3),
(14990,2,2),
(12067,8,2),
(17607,5,3),
(14497,4,2),
(13654,3,4),
(706,6,4),
(16271,5,2),
(17650,8,2),
(37781,3,5),
(15881,8,4),
(40440,1,4),
(5107,5,4),
(43841,5,2),
(21787,4,4),
(10572,2,2),
(13496,3,5),
(13497,7,2),
(13642,5,3),
(22320,3,5),
(16328,1,5),
(16255,5,4),
(10956,1,5),
(33609,4,5),
(34484,7,2),
(32951,1,5),
(11,6,3),
(4981,2,4),
(23919,3,2),
(5064,1,3),
(39774,8,5),
(3636,2,3),
(428,8,4),
(12764,4,4),
(3805,6,4),
(4900,5,5),
(11702,1,5),
(15055,3,5),
(30292,7,4),
(320,8,2),
(34497,7,4),
(5220,3,2),
(34507,3,2),
(39926,8,2),
(2657,1,2),
(5755,6,3),
(6514,7,4),
(37415,7,2),
(2744,2,5),
(14891,7,3),
(4407,6,4),
(5907,5,4),
(1078,7,5),
(18122,7,4),
(7178,5,5),
(4588,5,5),
(11038,3,4),
(11713,4,5),
(4952,7,4),
(1885,7,5),
(7613,6,5),
(5043,7,5),
(5470,7,2),
(10847,8,3),
(890,7,3),
(4406,5,3),
(4965,6,5),
(6192,6,5),
(7763,3,4),
(12296,2,2),
(15195,5,3),
(25079,4,5),
(27003,2,3),
(2187,6,4),
(27499,7,2),
(1103,8,2),
(18889,5,2),
(18892,2,5),
(13662,4,4),
(6,3,3),
(3,5,5),
(1,3,4),
(5,3,5),
(4214,4,4),
(1934,8,4),
(10692,3,4),
(14201,2,5),
(1875,6,3),
(3656,4,5),
(7815,6,4),
(12497,3,4),
(14028,4,3),
(14836,6,2),
(16981,4,4),
(29044,5,4),
(41913,2,5),
(11437,3,4),
(762,1,3),
(9712,4,5),
(32145,7,3),
(14990,7,5),
(12067,6,5),
(17607,4,3),
(14497,3,4),
(13654,3,5),
(706,7,5),
(16271,7,4),
(17650,2,4),
(37781,7,3),
(15881,1,5),
(40440,2,3),
(5107,2,5),
(43841,4,4),
(21787,5,3),
(10572,8,5),
(13496,6,5),
(13497,1,4),
(13642,3,4),
(22320,3,4),
(16328,6,4),
(16255,2,2),
(10956,3,4),
(33609,7,5),
(34484,6,3),
(32951,4,5),
(11,4,2),
(4981,3,2),
(23919,7,4),
(5064,7,2),
(39774,1,4),
(3636,1,4),
(428,1,3),
(12764,1,2),
(3805,1,5),
(4900,8,4),
(11702,8,5),
(15055,1,5),
(30292,6,5),
(320,2,4),
(34497,4,4),
(5220,7,4),
(34507,5,4),
(39926,1,5),
(2657,2,4),
(5755,5,2),
(6514,7,4),
(37415,6,2),
(2744,7,5),
(14891,7,2),
(4407,4,2),
(5907,1,4),
(1078,7,2),
(18122,7,3),
(7178,4,4),
(4588,2,5),
(11038,1,5),
(11713,5,3),
(4952,4,4),
(1885,8,3),
(7613,6,3),
(5043,7,3),
(5470,8,3),
(10847,1,5),
(890,6,3),
(4406,7,4),
(4965,6,4),
(6192,6,5),
(7763,5,4),
(12296,3,5),
(15195,4,3),
(25079,1,2),
(27003,5,5),
(2187,6,4),
(27499,6,3),
(1103,2,3),
(18889,1,3),
(18892,7,4),
(13662,2,5),
(6,3,2),
(3,1,2),
(1,6,4),
(5,8,3),
(4214,1,5),
(1934,2,5),
(10692,3,3),
(14201,5,3),
(1875,7,5),
(3656,5,3),
(7815,2,4),
(12497,3,2),
(14028,6,2),
(14836,7,5),
(16981,1,3),
(29044,7,3),
(41913,8,3),
(11437,1,4),
(762,2,5),
(9712,5,5),
(32145,5,2),
(14990,2,4),
(12067,3,4),
(17607,2,5),
(14497,1,3);

--create and populate Book Loans table
CREATE TABLE tbl_bookLoans (
	BookID INT FOREIGN KEY REFERENCES tbl_books(BookID),
	BranchID INT FOREIGN KEY REFERENCES tbl_libraryBranch(BranchID),
	CardNo INT FOREIGN KEY REFERENCES tbl_borrower(CardNo),
	DateOut DATE,
	DueDate DATE
);
INSERT INTO tbl_bookLoans
VALUES (13654,6,1000000037,'6/15/2018','7/6/2018'),
(5107,2,1000000043,'6/11/2018','6/29/2018'),
(5107,2,1000000043,'6/11/2018','10/1/2018'),
(13497,6,1000000043,'6/11/2018','7/2/2018'),
(16255,6,1000000043,'6/11/2018','7/2/2018'),
(13662,6,1000000043,'6/11/2018','7/2/2018'),
(1885,6,1000000043,'6/11/2018','7/2/2018'),
(4407,6,1000000043,'6/11/2018','7/2/2018'),
(37781,3,1000000098,'6/15/2018','7/6/2018'),
(15055,3,1000000098,'6/15/2018','7/6/2018'),
(5220,3,1000000098,'6/15/2018','7/6/2018'),
(13654,3,1000000098,'6/15/2018','7/6/2018'),
(6,3,1000000098,'6/15/2018','7/6/2018'),
(13642,3,1000000098,'6/15/2018','7/6/2018'),
(22320,3,1000000098,'6/15/2018','7/6/2018'),
(17650,2,1000000041,'5/22/2018','6/12/2018'),
(37781,5,1000000000,'5/16/2018','6/6/2018'),
(15881,5,1000000022,'5/19/2018','6/9/2018'),
(40440,4,1000000077,'5/23/2018','6/13/2018'),
(5107,6,1000000078,'5/26/2018','6/16/2018'),
(43841,8,1000000085,'5/6/2018','5/27/2018'),
(21787,6,1000000067,'6/12/2018','7/3/2018'),
(10572,6,1000000038,'6/6/2018','6/27/2018'),
(13496,4,1000000094,'5/8/2018','5/29/2018'),
(13497,6,1000000065,'5/21/2018','6/11/2018'),
(13642,8,1000000083,'5/26/2018','6/16/2018'),
(22320,8,1000000095,'5/20/2018','6/10/2018'),
(16328,7,1000000004,'5/7/2018','5/28/2018'),
(16255,6,1000000069,'5/26/2018','6/16/2018'),
(10956,1,1000000003,'5/25/2018','6/15/2018'),
(33609,1,1000000075,'5/19/2018','6/9/2018'),
(34484,4,1000000050,'6/28/2018','7/19/2018'),
(32951,5,1000000016,'6/21/2018','7/12/2018'),
(11,4,1000000020,'5/26/2018','6/16/2018'),
(4981,6,1000000048,'6/16/2018','7/7/2018'),
(23919,1,1000000051,'6/20/2018','7/11/2018'),
(5064,3,1000000001,'6/17/2018','7/8/2018'),
(39774,5,1000000053,'6/26/2018','7/17/2018'),
(3636,8,1000000005,'6/21/2018','7/12/2018'),
(428,2,1000000024,'5/15/2018','6/5/2018'),
(12764,4,1000000030,'6/19/2018','7/10/2018'),
(3805,2,1000000019,'6/12/2018','7/3/2018'),
(4900,7,1000000072,'6/10/2018','7/1/2018'),
(11702,1,1000000057,'5/17/2018','6/7/2018'),
(15055,4,1000000006,'6/25/2018','7/16/2018'),
(30292,2,1000000093,'5/31/2018','6/21/2018'),
(320,2,1000000054,'5/22/2018','6/12/2018'),
(34497,4,1000000017,'6/12/2018','7/3/2018'),
(5220,8,1000000063,'5/10/2018','5/31/2018'),
(34507,4,1000000039,'6/18/2018','7/9/2018'),
(39926,6,1000000074,'5/30/2018','6/20/2018'),
(2657,6,1000000070,'5/8/2018','5/29/2018'),
(5755,5,1000000066,'5/14/2018','6/4/2018'),
(6514,8,1000000087,'5/7/2018','5/28/2018'),
(37415,5,1000000068,'6/24/2018','7/15/2018'),
(2744,6,1000000025,'6/28/2018','7/19/2018'),
(14891,6,1000000011,'5/8/2018','5/29/2018'),
(4407,7,1000000012,'6/27/2018','7/18/2018'),
(5907,7,1000000096,'5/26/2018','6/16/2018'),
(1078,5,1000000045,'5/24/2018','6/14/2018'),
(18122,8,1000000031,'5/25/2018','6/15/2018'),
(7178,1,1000000082,'5/7/2018','5/28/2018'),
(4588,4,1000000009,'5/31/2018','6/21/2018'),
(11038,3,1000000081,'5/27/2018','6/17/2018'),
(11713,6,1000000034,'5/10/2018','5/31/2018'),
(4952,6,1000000064,'5/17/2018','6/7/2018'),
(1885,6,1000000090,'5/26/2018','6/16/2018'),
(7613,8,1000000073,'6/20/2018','7/11/2018'),
(5043,8,1000000076,'6/8/2018','6/29/2018'),
(5470,7,1000000056,'6/27/2018','7/18/2018'),
(10847,8,1000000013,'6/24/2018','7/15/2018'),
(890,3,1000000015,'6/14/2018','7/5/2018'),
(4406,6,1000000044,'5/20/2018','6/10/2018'),
(4965,7,1000000071,'5/11/2018','6/1/2018'),
(6192,5,1000000029,'5/12/2018','6/2/2018'),
(7763,4,1000000014,'5/24/2018','6/14/2018'),
(12296,1,1000000089,'5/27/2018','6/17/2018'),
(15195,4,1000000028,'6/11/2018','7/2/2018'),
(25079,1,1000000049,'5/13/2018','6/3/2018'),
(27003,1,1000000060,'5/26/2018','6/16/2018'),
(2187,3,1000000018,'6/24/2018','7/15/2018'),
(27499,7,1000000010,'6/28/2018','7/19/2018'),
(1103,2,1000000008,'6/14/2018','7/5/2018'),
(18889,7,1000000091,'6/3/2018','6/24/2018'),
(18892,2,1000000042,'5/30/2018','6/20/2018'),
(13662,6,1000000035,'6/13/2018','7/4/2018'),
(6,6,1000000021,'6/26/2018','7/17/2018'),
(3,6,1000000062,'5/22/2018','6/12/2018'),
(1,3,1000000084,'6/2/2018','6/23/2018'),
(5,5,1000000061,'6/22/2018','7/13/2018'),
(4214,7,1000000092,'6/19/2018','7/10/2018');

--create and populate loans by branch table (used for query5)
CREATE TABLE totalLoansByBranch (
	branch_id INT,
	total_loans INT)
INSERT INTO totalLoansByBranch (branch_id)
VALUES (1),
(2),
(3),
(4),
(5),
(6),
(7),
(8);
CREATE TABLE tbl_moreThanFive(
	name varchar(50),
	address varchar(100),
	count_of_books INT)
GO
--------------------------------------------------STORED QUERIES---------------------------------------------------------------------
CREATE PROCEDURE query1 
AS
SELECT BranchName, Title, No_of_copies 
FROM tbl_bookCopies
INNER JOIN tbl_books ON tbl_books.BookId = tbl_bookCopies.BookID
INNER JOIN tbl_libraryBranch ON tbl_libraryBranch.BranchID = tbl_bookCopies.BranchID
WHERE tbl_books.Title = 'The Lost Tribe' AND tbl_libraryBranch.BranchName='Sharpstown';
GO

CREATE PROCEDURE query2
AS
SELECT BranchName, Title, No_of_copies 
FROM tbl_bookCopies
INNER JOIN tbl_books ON tbl_books.BookId = tbl_bookCopies.BookID
INNER JOIN tbl_libraryBranch ON tbl_libraryBranch.BranchID = tbl_bookCopies.BranchID
WHERE tbl_books.Title = 'The Lost Tribe';
GO

CREATE PROCEDURE query3
AS
SELECT borrower.Name
FROM tbl_borrower borrower
WHERE borrower.CardNo NOT IN (SELECT CardNo FROM tbl_bookLoans);
GO

CREATE PROCEDURE query4
AS
SELECT books.Title, borrower.Name, BorrowerAddress
FROM tbl_libraryBranch library
inner join tbl_bookLoans loans on loans.BranchID = library.BranchID
inner join tbl_books books on books.BookId = loans.BookID
inner join tbl_borrower borrower on borrower.CardNo = loans.CardNo
WHERE library.BranchName = 'Sharpstown' AND loans.DueDate = '10/1/2018';
GO

CREATE PROCEDURE query5 
AS
select * 
FROM tbl_libraryBranch branch
inner join totalLoansByBranch loans on branch.BranchID = loans.branch_id;
GO

CREATE PROCEDURE query6
AS
SELECT borrower.Name, borrower.BorrowerAddress, Count(*) AS NoBooksCheckedOut FROM tbl_borrower borrower
INNER JOIN tbl_bookLoans loans ON borrower.CardNo = loans.CardNo
GROUP BY borrower.Name, BorrowerAddress HAVING COUNT(*) > 5;
GO

CREATE PROCEDURE query7
AS
SELECT books.Title, copies.No_of_copies FROM tbl_books books
	INNER JOIN tbl_bookAuthors authors ON books.BookId=authors.BookId
	INNER JOIN tbl_bookCopies copies ON copies.BookID=books.BookId
	INNER JOIN tbl_libraryBranch branch ON branch.BranchID=copies.BranchID
WHERE authors.AuthorName='Stephen King' and branch.BranchName='Central';
GO

-------------------------------------------------------------------------------------------------------------------------------
EXEC query1;
EXEC query2;
EXEC query3;
EXEC query4;
EXEC query5;
EXEC query6;
EXEC query7;
GO

--------------------------------------------------------------------------------------------------------------------------------
DROP TABLE tbl_bookAuthors;
DROP TABLE tbl_bookLoans;
DROP TABLE tbl_borrower;
DROP TABLE tbl_bookCopies;
DROP TABLE tbl_libraryBranch;
DROP TABLE tbl_books;
DROP TABLE tbl_publishers;
DROP TABLE totalLoansByBranch;
DROP TABLE tbl_moreThanFive;
GO

DROP PROC query1;
DROP PROC query2;
DROP PROC query3;
DROP PROC query4;
DROP PROC query5;
DROP PROC query6;
DROP PROC query7;
GO

USE master;
DROP DATABASE db_booksFinalProject;